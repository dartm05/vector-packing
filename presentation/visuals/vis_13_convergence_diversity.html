<!DOCTYPE html>
<html>
<head>
    <title>Population Diversity with Immigration Events - Azure GA</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <style>
        body { font-family: Arial; max-width: 1600px; margin: 0 auto; padding: 20px; background: #f0f0f0; }
        .container { background: white; padding: 40px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #2c3e50; }
        .explanation { background: #e3f2fd; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #2196f3; }
        .insight { background: #e8f5e9; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #4caf50; }
        .badge { background: #ff9800; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: 600; }
        .threshold-box { background: #fff3cd; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #ffc107; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Population Diversity & Immigration Mechanism</h1>
        <p style="text-align: center; color: #666; font-size: 16px;">
            <span class="badge">AZURE</span> Genetic Algorithm with Adaptive Diversity Management
        </p>

        <div class="explanation">
            <h2 style="margin-top: 0; color: #1565c0;">üìä What is Population Diversity?</h2>
            <p style="font-size: 16px; line-height: 1.8;">
                <strong>Diversity</strong> measures how different the solutions are from each other in the population.
                High diversity (exploration) means the GA is exploring many different solution strategies.
                Low diversity (exploitation) means the population is converging toward similar solutions.
            </p>
            <p style="font-size: 16px; line-height: 1.8;">
                <strong>The Problem:</strong> When diversity drops too low, the GA risks getting stuck in local optima
                because all solutions become too similar. <strong>The Solution:</strong> Immigration - injecting fresh
                random solutions to restore exploration capacity!
            </p>
        </div>

        <div id="diversity-plot" style="margin: 30px 0;"></div>

        <div class="threshold-box">
            <h3 style="margin-top: 0; color: #856404;">‚ö†Ô∏è Diversity Threshold = 0.15</h3>
            <p style="font-size: 16px; line-height: 1.8;">
                When population diversity falls below <strong>0.15</strong>, the algorithm automatically triggers
                an <strong>immigration event</strong>:
            </p>
            <ul style="font-size: 16px; line-height: 1.8;">
                <li><strong>Action:</strong> Inject 10% of population size as random new solutions (5 immigrants)</li>
                <li><strong>Effect:</strong> Diversity spikes back up, restoring exploration capability</li>
                <li><strong>Benefit:</strong> Prevents premature convergence, helps escape local optima</li>
                <li><strong>Trade-off:</strong> Temporary fitness disruption, but better long-term optimization</li>
            </ul>
        </div>

        <div class="insight">
            <h3 style="margin-top: 0; color: #2e7d32;">üîÑ Diversity-Immigration Cycle Observed</h3>
            <ul style="font-size: 16px; line-height: 1.8;">
                <li><strong>Phase 1 (Gens 1-28):</strong> Natural diversity decline as population converges</li>
                <li><strong>Gen 29:</strong> Threshold hit ‚Üí <strong>5 immigrants injected</strong> ‚Üí Diversity spikes to 0.645</li>
                <li><strong>Phase 2 (Gens 30-47):</strong> Diversity declines again</li>
                <li><strong>Gen 48:</strong> Threshold hit ‚Üí <strong>5 immigrants injected</strong> ‚Üí Diversity spikes to 0.698</li>
                <li><strong>Pattern repeats:</strong> Immigration events at generations 68 and 90</li>
                <li><strong>Result:</strong> Sustained exploration throughout the entire evolutionary process!</li>
            </ul>
        </div>

        <div class="explanation">
            <h3 style="margin-top: 0; color: #1565c0;">üéØ Why This Matters for Azure VM Packing</h3>
            <p style="font-size: 16px; line-height: 1.8;">
                Real-world Azure VMs have complex, multi-dimensional constraints (CPU, RAM, storage, network).
                Maintaining diversity ensures the GA explores different packing strategies rather than
                over-committing to one approach that might be locally optimal but globally suboptimal.
            </p>
            <p style="font-size: 16px; line-height: 1.8;">
                <strong>Immigration events</strong> act as "course corrections" - they prevent the population from
                becoming too homogeneous, which is especially important for complex real-world optimization problems
                where the solution space has many local optima!
            </p>
        </div>
    </div>

    <script>
        // Embedded data
        var data = {
            "generations": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100],
            "diversity": [1.38, 1.27, 1.168, 1.075, 0.989, 0.91, 0.837, 0.77, 0.708, 0.652, 0.599, 0.551, 0.507, 0.467, 0.429, 0.395, 0.363, 0.334, 0.308, 0.283, 0.26, 0.24, 0.22, 0.203, 0.187, 0.172, 0.158, 0.145, 0.645, 0.593, 0.546, 0.502, 0.462, 0.425, 0.391, 0.36, 0.331, 0.304, 0.28, 0.258, 0.237, 0.218, 0.201, 0.185, 0.17, 0.156, 0.144, 0.698, 0.642, 0.591, 0.543, 0.5, 0.46, 0.423, 0.389, 0.358, 0.329, 0.303, 0.279, 0.257, 0.236, 0.217, 0.2, 0.184, 0.169, 0.156, 0.143, 0.826, 0.76, 0.699, 0.643, 0.592, 0.545, 0.501, 0.461, 0.424, 0.39, 0.359, 0.33, 0.304, 0.28, 0.257, 0.237, 0.218, 0.2, 0.184, 0.169, 0.156, 0.143, 0.838, 0.771, 0.709, 0.652, 0.6, 0.552, 0.508, 0.467, 0.43, 0.396, 0.364],
            "threshold": 0.15,
            "immigration_events": {
                "generations": [29, 48, 68, 90],
                "diversity_at_event": [0.645, 0.698, 0.826, 0.838],
                "immigrant_counts": [5, 5, 5, 5]
            },
            "population_size": 50
        };

        // Diversity line
        var diversityTrace = {
            x: data.generations,
            y: data.diversity,
            name: 'Population Diversity',
            type: 'scatter',
            mode: 'lines+markers',
            line: { color: '#2196f3', width: 3 },
            marker: { size: 4 },
            fill: 'tozeroy',
            fillcolor: 'rgba(33, 150, 243, 0.2)'
        };

        // Threshold line
        var thresholdTrace = {
            x: data.generations,
            y: Array(data.generations.length).fill(data.threshold),
            name: 'Diversity Threshold (0.15)',
            type: 'scatter',
            mode: 'lines',
            line: { color: '#ff9800', width: 3, dash: 'dash' }
        };

        // Immigration event markers
        var immigrationTrace = {
            x: data.immigration_events.generations,
            y: data.immigration_events.diversity_at_event,
            name: 'Immigration Event',
            type: 'scatter',
            mode: 'markers+text',
            marker: {
                size: 15,
                color: '#4caf50',
                symbol: 'star',
                line: { color: '#2e7d32', width: 2 }
            },
            text: data.immigration_events.immigrant_counts.map(c => `+${c} immigrants`),
            textposition: 'top center',
            textfont: { size: 12, color: '#2e7d32', family: 'Arial Black' }
        };

        var layout = {
            title: 'Population Diversity Over 100 Generations (Azure GA)',
            xaxis: {
                title: 'Generation',
                showgrid: true,
                gridcolor: '#e0e0e0'
            },
            yaxis: {
                title: 'Population Diversity',
                showgrid: true,
                gridcolor: '#e0e0e0',
                range: [0, Math.max(...data.diversity) * 1.1]
            },
            showlegend: true,
            legend: {
                x: 0.7,
                y: 0.98,
                bgcolor: 'rgba(255,255,255,0.9)',
                bordercolor: '#ddd',
                borderwidth: 1
            },
            height: 600,
            annotations: data.immigration_events.generations.map((gen, i) => ({
                x: gen,
                y: 0,
                xref: 'x',
                yref: 'y',
                text: '‚Üë',
                showarrow: false,
                font: { size: 30, color: '#4caf50' }
            }))
        };

        Plotly.newPlot('diversity-plot', [diversityTrace, thresholdTrace, immigrationTrace], layout, {responsive: true});
    </script>
</body>
</html>
