<!DOCTYPE html>
<html>
<head>
    <title>WOC Co-Occurrence Matrix</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <style>
        body { font-family: Arial; max-width: 1400px; margin: 0 auto; padding: 20px; background: #f0f0f0; }
        .container { background: white; padding: 40px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #2c3e50; }
        .explanation { background: #e8f5e9; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #27ae60; }
        .formula { background: #f8f9fa; padding: 15px; border-radius: 5px; font-family: 'Courier New'; font-size: 18px; text-align: center; margin: 15px 0; }
        .insight { background: #fff3cd; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #ffc107; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Wisdom of Crowds: Pattern Learning via Co-Occurrence Matrix</h1>
        
        <div class="explanation">
            <h2 style="margin-top: 0; color: #1b5e20;">What is a Co-Occurrence Matrix?</h2>
            <p style="font-size: 16px; line-height: 1.8;">
                A co-occurrence matrix <strong>C</strong> tracks how often pairs of VMs appear together on the same server 
                across the top 20 solutions from the GA population. High values indicate <strong>strong affinity</strong> 
                between VMs - they work well together!
            </p>
            
            <div class="formula">
                C[i][j] = Œ£<sub>s ‚àà Top-20</sub> ùüô{VM<sub>i</sub> and VM<sub>j</sub> on same server in s}
            </div>
            
            <p style="font-size: 16px; margin-top: 15px;">
                <strong>Range:</strong> C[i][j] ‚àà [0, 20]<br>
                <strong>0:</strong> VMs never co-locate ‚Üí likely incompatible<br>
                <strong>20:</strong> VMs always together ‚Üí strong synergy!
            </p>
        </div>
        
        <div id="heatmap" style="margin: 30px 0;"></div>
        
        <div class="insight">
            <h3 style="margin-top: 0; color: #856404;">üîç Why VMs Co-locate: Complementary Resources</h3>
            <p style="font-size: 16px; line-height: 1.8;">
                <strong>Example Pattern Discovery:</strong>
            </p>
            <table style="width: 100%; border-collapse: collapse; margin: 15px 0;">
                <tr style="background: #e8f5e9;">
                    <th style="padding: 12px; border: 1px solid #ddd;">VM</th>
                    <th style="padding: 12px; border: 1px solid #ddd;">CPU</th>
                    <th style="padding: 12px; border: 1px solid #ddd;">RAM</th>
                    <th style="padding: 12px; border: 1px solid #ddd;">Storage</th>
                    <th style="padding: 12px; border: 1px solid #ddd;">Profile</th>
                </tr>
                <tr>
                    <td style="padding: 12px; border: 1px solid #ddd;"><strong>VM 3</strong></td>
                    <td style="padding: 12px; border: 1px solid #ddd;">8 cores (HIGH)</td>
                    <td style="padding: 12px; border: 1px solid #ddd;">8 GB (LOW)</td>
                    <td style="padding: 12px; border: 1px solid #ddd;">50 GB</td>
                    <td style="padding: 12px; border: 1px solid #ddd;">CPU-heavy</td>
                </tr>
                <tr style="background: #f8f9fa;">
                    <td style="padding: 12px; border: 1px solid #ddd;"><strong>VM 7</strong></td>
                    <td style="padding: 12px; border: 1px solid #ddd;">2 cores (LOW)</td>
                    <td style="padding: 12px; border: 1px solid #ddd;">28 GB (HIGH)</td>
                    <td style="padding: 12px; border: 1px solid #ddd;">40 GB</td>
                    <td style="padding: 12px; border: 1px solid #ddd;">RAM-heavy</td>
                </tr>
                <tr style="background: #e3f2fd;">
                    <td colspan="5" style="padding: 12px; border: 1px solid #ddd; text-align: center;">
                        <strong>Co-occurrence: C[3][7] = 18/20</strong> ‚Üí These VMs frequently pair up!<br>
                        <span style="color: #1565c0;">Complementary profiles = efficient server packing</span>
                    </td>
                </tr>
            </table>
        </div>
        
        <div class="explanation">
            <h3 style="margin-top: 0; color: #1b5e20;">How WOC Uses the Matrix</h3>
            <ol style="font-size: 16px; line-height: 1.8;">
                <li><strong>Identify Patterns:</strong> Build matrix from top 20 GA solutions</li>
                <li><strong>Compute Affinity:</strong> For each VM-Server pair, sum co-occurrence with VMs already on that server</li>
                <li><strong>Guided Placement:</strong> Place VMs on servers where they have high affinity</li>
                <li><strong>Fast Construction:</strong> Build complete solution in O(N¬≤) time</li>
            </ol>
            
            <div class="formula">
                affinity(VM<sub>i</sub>, Server<sub>j</sub>) = Œ£<sub>k ‚àà Server<sub>j</sub></sub> C[i][k] / |Server<sub>j</sub>|
            </div>
        </div>
        
        <div style="background: #f3e5f5; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #9c27b0;">
            <h3 style="color: #6a1b9a; margin-top: 0;">üìä Matrix Properties</h3>
            <ul style="font-size: 16px; line-height: 1.8;">
                <li><strong>Symmetric:</strong> C[i][j] = C[j][i] (co-location is bidirectional)</li>
                <li><strong>Sparse:</strong> Most VM pairs never co-locate (many zeros)</li>
                <li><strong>Space:</strong> O(N¬≤) - manageable even for N=200 (40K entries)</li>
                <li><strong>Time to build:</strong> O(T √ó N¬≤) where T=20 (top solutions)</li>
                <li><strong>Captures implicit knowledge:</strong> GA discovers patterns, WOC extracts them</li>
            </ul>
        </div>
    </div>

    <script>
        // Generate example co-occurrence matrix (10 VMs for visualization)
        const n = 10;
        const vmLabels = Array.from({length: n}, (_, i) => `VM${i}`);
        
        // Simulate realistic co-occurrence data
        function generateCooccurrenceData() {
            const matrix = Array(n).fill(0).map(() => Array(n).fill(0));
            
            // Create some clusters of VMs that often co-locate
            const clusters = [
                [0, 1, 2],  // Cluster 1
                [3, 4, 5],  // Cluster 2
                [6, 7],     // Cluster 3
                [8, 9]      // Cluster 4
            ];
            
            clusters.forEach(cluster => {
                cluster.forEach(i => {
                    cluster.forEach(j => {
                        if (i !== j) {
                            // VMs in same cluster have high co-occurrence (15-20)
                            matrix[i][j] = 15 + Math.floor(Math.random() * 6);
                        } else {
                            matrix[i][j] = 20; // Always with itself
                        }
                    });
                });
            });
            
            // Add some cross-cluster occasional co-locations (1-5)
            for (let i = 0; i < n; i++) {
                for (let j = 0; j < n; j++) {
                    if (matrix[i][j] === 0 && i !== j && Math.random() < 0.3) {
                        const val = 1 + Math.floor(Math.random() * 5);
                        matrix[i][j] = val;
                        matrix[j][i] = val; // Keep symmetric
                    }
                }
            }
            
            return matrix;
        }
        
        const matrix = generateCooccurrenceData();
        
        // Create heatmap
        const heatmapData = [{
            z: matrix,
            x: vmLabels,
            y: vmLabels,
            type: 'heatmap',
            colorscale: [
                [0, '#f7fbff'],
                [0.2, '#deebf7'],
                [0.4, '#9ecae1'],
                [0.6, '#4292c6'],
                [0.8, '#2171b5'],
                [1, '#08519c']
            ],
            colorbar: {
                title: 'Co-occurrence<br>Count',
                titleside: 'right'
            },
            text: matrix.map(row => row.map(val => `Count: ${val}`)),
            hovertemplate: '%{y} + %{x}<br>%{text}<extra></extra>'
        }];
        
        const layout = {
            title: {
                text: 'Co-Occurrence Matrix Heatmap (Example: 10 VMs, Top 20 Solutions)',
                font: { size: 18, color: '#2c3e50' }
            },
            xaxis: {
                title: 'Virtual Machine',
                side: 'bottom'
            },
            yaxis: {
                title: 'Virtual Machine',
                autorange: 'reversed'
            },
            annotations: [
                {
                    x: 1,
                    y: 0,
                    text: 'Dark blue = Strong affinity<br>(VMs often together)',
                    showarrow: true,
                    arrowhead: 2,
                    ax: 80,
                    ay: -50,
                    font: { size: 12, color: '#08519c' },
                    bgcolor: 'rgba(255,255,255,0.9)',
                    bordercolor: '#08519c',
                    borderwidth: 2
                },
                {
                    x: 8,
                    y: 3,
                    text: 'Light blue = Weak/no affinity<br>(VMs rarely together)',
                    showarrow: true,
                    arrowhead: 2,
                    ax: -80,
                    ay: 50,
                    font: { size: 12, color: '#9ecae1' },
                    bgcolor: 'rgba(255,255,255,0.9)',
                    bordercolor: '#9ecae1',
                    borderwidth: 2
                }
            ]
        };
        
        Plotly.newPlot('heatmap', heatmapData, layout, {responsive: true});
    </script>
</body>
</html>
